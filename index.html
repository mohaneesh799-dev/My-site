<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Romantic Journey</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:ital@1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=1.5">
</head>
<body>

  <div id="dark-room">
    <div id="lamp-container">
        <div id="lamp-wire"></div>
        <div id="lamp-handle" class="glowing-heart"></div>
    </div>
    <p class="instruction">Pull the heart to begin...</p>
</div>

    <div id="particle-container"></div>

    <audio id="bg-music" loop>
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <section id="start-page" class="panel active start-bg">
        <div class="content-box">
            <h1 class="cursive">Welcome My Queen...</h1>
            <p>Click here to see inside.</p>
            <div class="nav-links">
                <button class="start-btn" onclick="startJourney()">Click</button>
            </div>
        </div>
    </section>

    <section id="int1" class="panel bg-1">
        <div class="content-box">
            <div class="nav-links">
                <button onclick="nextPage('int2')">Next ‚Üí</button>
            </div>
        </div>
    </section>

    <section id="int2" class="panel bg-2">
        <div class="content-box">
            <div class="nav-links">
                <button onclick="nextPage('int1')">‚Üê Back</button>
                <button onclick="nextPage('int3')">Continue ‚Üí</button>
            </div>
        </div>
    </section>

    <section id="int3" class="panel bg-3">
        <div class="content-box">
            <div class="nav-links">
                <button onclick="nextPage('int2')">‚Üê Back</button>
                <button onclick="nextPage('int4')">Final page ‚Üí</button>
            </div>
        </div>
    </section>

    <section id="int4" class="panel bg-4">
        <div class="content-box">
            <div class="nav-links">
                <button onclick="nextPage('int3')">‚Üê Back</button>
                <button onclick="nextPage('start-page')">Go back to start page</button>
            </div>
        </div>
    </section>

    <script>
    const music = document.getElementById('bg-music');
    const particleContainer = document.getElementById('particle-container');
    const darkRoom = document.getElementById('dark-room');
    const handle = document.getElementById('lamp-handle');
    const wire = document.getElementById('lamp-wire');

    let isDragging = false;
    let startY = 0;

    // --- LAMP THREAD LOGIC ---
    const startDrag = (e) => {
        isDragging = true;
        startY = e.touches ? e.touches[0].clientY : e.clientY;
        
        // MOBILE AUDIO FIX: "Wake up" the audio engine on the first touch
        music.play().then(() => {
            music.pause(); 
        }).catch(e => console.log("Audio primed"));
    };

    const onDrag = (e) => {
        if (!isDragging) return;
        const currentY = e.touches ? e.touches[0].clientY : e.clientY;
        const delta = Math.max(0, currentY - startY);
        
        if (delta < 250) {
            handle.style.transform = `translateY(${delta}px) rotate(-45deg)`;
            wire.style.height = (200 + delta) + "px";
        }
        
        if (delta > 150) {
            isDragging = false;
            revealSite();
        }
    };

    const stopDrag = () => {
        if (!isDragging) return;
        isDragging = false;
        handle.style.transition = "0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
        wire.style.transition = "0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
        handle.style.transform = "translateY(0) rotate(-45deg)";
        wire.style.height = "200px";
    };

    handle.addEventListener('mousedown', startDrag);
    handle.addEventListener('touchstart', startDrag);
    window.addEventListener('mousemove', onDrag);
    window.addEventListener('touchmove', onDrag);
    window.addEventListener('mouseup', stopDrag);
    window.addEventListener('touchend', stopDrag);

    function revealSite() {
        darkRoom.style.opacity = "0";
        // Play music now that we have user interaction
        music.currentTime = 0;
        music.play();

        setTimeout(() => {
            darkRoom.style.display = "none";
            // Ensure the start page is ready
            const startPage = document.getElementById('start-page');
            startPage.classList.add('active');
            startPage.style.opacity = "1";
        }, 800);
    }

    function startJourney() {
        nextPage('int1');
    }

    // --- GLOWING PARTICLE SYSTEM ---
    function createParticle() {
        const symbols = ['‚ú®', 'üíñ', 'üå∏', 'ü§ç', '‚≠ê'];
        const particle = document.createElement('div');
        
        particle.className = 'particle';
        particle.innerHTML = symbols[Math.floor(Math.random() * symbols.length)];
        
        particle.style.left = Math.random() * 100 + 'vw';
        const size = (Math.random() * 15 + 12) + 'px';
        particle.style.fontSize = size;
        
        // Add a slight random delay so they don't all look the same
        const duration = (Math.random() * 3 + 4) + 's';
        particle.style.animationDuration = duration;

        particleContainer.appendChild(particle);

        setTimeout(() => { particle.remove(); }, 6000);
    }

    setInterval(createParticle, 400);

    // --- NAVIGATION SYSTEM ---
    function nextPage(pageId) {
        const current = document.querySelector('.panel.active');
        if(!current) return;

        current.style.opacity = '0';
        current.style.transform = 'scale(1.05)';
        current.style.filter = 'blur(15px)';

        setTimeout(() => {
            current.classList.remove('active');
            current.style.transform = 'scale(1)'; 
            current.style.filter = 'blur(0px)';

            const next = document.getElementById(pageId);
            if(next) {
                next.classList.add('active');
                next.style.opacity = '1';
            }
        }, 1000);
    }
</script>
</body>
</html>
