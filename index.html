<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>A Romantic Journey</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:ital@1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css?v=3.0">
    
</head>
<body>

    <div id="dark-room">
        <div id="lamp-container">
            <div id="lamp-wire"></div>
            <div id="lamp-handle" class="glowing-heart"></div>
        </div>
        <p class="instruction">Pull the heart to begin...</p>
    </div>

    <div id="particle-container"></div>

    <audio id="bg-music" loop preload="auto">
        <source src="music.mp3" type="audio/mpeg">
    </audio>

    <div id="pencil-trigger" onclick="checkPassword()">üëª</div>
    <canvas id="scratch-pad"></canvas>
    <button id="done-btn" onclick="validateDrawing()">Done Drawing</button>

    <section id="start-page" class="panel active start-bg">
        <div class="content-box">
            <h1 class="cursive">Welcome My Queen...</h1>
            <p>Click here to see inside.</p>
            <div class="nav-links">
                <button class="start-btn" onclick="startJourney()">Click</button>
            </div>
        </div>
    </section>

    <section id="int1" class="panel bg-1">
        <div class="content-box">
            <div class="nav-links">
                <button onclick="nextPage('int2')">Next ‚Üí</button>
            </div>
        </div>
    </section>

    <section id="int2" class="panel bg-2">
        <div class="content-box">
            <div class="nav-links">
                <button onclick="nextPage('int1')">‚Üê Back</button>
                <button onclick="nextPage('int3')">Continue ‚Üí</button>
            </div>
        </div>
    </section>

    <section id="int3" class="panel bg-3">
        <div class="content-box">
            <div class="nav-links">
                <button onclick="nextPage('int2')">‚Üê Back</button>
                <button onclick="nextPage('int4')">Final page ‚Üí</button>
            </div>
        </div>
    </section>

    <section id="int4" class="panel bg-4">
        <div class="content-box">
            <h2 class="cursive">The End?</h2>
            <p>Or is there more to find?</p>
            <div class="nav-links">
                <button onclick="nextPage('int3')">‚Üê Back</button>
                <button onclick="nextPage('start-page')">Go back to start page</button>
            </div>
        </div>
    </section>

    <section id="secret-page" class="panel">
        <div class="content-box">
            <h1 class="cursive">For Your Eyes Only</h1>
            <p>You found the secret! I love you more than words can say.</p>
            <div class="nav-links">
               <button onclick="resetToLamp()">Back to Start</button>
            </div>
        </div>
    </section>
<script>
   const music = document.getElementById('bg-music');
const particleContainer = document.getElementById('particle-container');
const darkRoom = document.getElementById('dark-room');
const handle = document.getElementById('lamp-handle');
const wire = document.getElementById('lamp-wire');

let isDragging = false;
let startY = 0;

// --- LAMP THREAD LOGIC ---
const startDrag = (e) => {
    isDragging = true;
    startY = e.touches ? e.touches[0].clientY : e.clientY;
    music.play().then(() => music.pause()).catch(e => {});
};

const onDrag = (e) => {
    if (!isDragging) return;
    const currentY = e.touches ? e.touches[0].clientY : e.clientY;
    const delta = Math.max(0, currentY - startY);
    if (delta < 250) {
        handle.style.transform = `translateY(${delta}px) rotate(-45deg)`;
        wire.style.height = (200 + delta) + "px";
    }
    if (delta > 160) {
        isDragging = false;
        revealSite();
    }
};

const stopDrag = () => {
    if (!isDragging) return;
    isDragging = false;
    handle.style.transition = "0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
    wire.style.transition = "0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)";
    handle.style.transform = "translateY(0) rotate(-45deg)";
    wire.style.height = "200px";
};

handle.addEventListener('mousedown', startDrag);
handle.addEventListener('touchstart', startDrag, {passive: false});
window.addEventListener('mousemove', onDrag);
window.addEventListener('touchmove', onDrag, {passive: false});
window.addEventListener('mouseup', stopDrag);
window.addEventListener('touchend', stopDrag);

function revealSite() {
    music.currentTime = 0;
    music.play();
    handle.style.transform = ""; 
    requestAnimationFrame(() => {
        handle.classList.add('heart-zoom');
        wire.style.opacity = "0";
        document.querySelector('.instruction').style.opacity = "0";
    });
    setTimeout(() => {
        darkRoom.style.opacity = "0";
        setTimeout(() => {
            darkRoom.style.display = "none";
            document.getElementById('start-page').classList.add('active');
            document.getElementById('start-page').style.opacity = "1";
        }, 800);
    }, 1000); 
}

// --- NAVIGATION ---
function nextPage(pageId) {
    const current = document.querySelector('.panel.active');
    if(!current) return;
    current.style.opacity = '0';
    current.style.transform = 'scale(1.05)';
    setTimeout(() => {
        current.classList.remove('active');
        const next = document.getElementById(pageId);
        if(next) {
            next.classList.add('active');
            next.style.opacity = '1';
            next.style.transform = 'scale(1)';
            const pencil = document.getElementById('pencil-trigger');
            if(pencil) pencil.style.display = (pageId === 'int4') ? 'flex' : 'none';
        }
    }, 1000);
}

function startJourney() { nextPage('int1'); }

// --- UPDATED SECRET LOCK (TEXT ONLY) ---
function checkPassword() {
    const pass = prompt("Enter the secret code to see the secret page:");
    if (pass === "1234") { 
        // Directly open the secret page if password is correct
        nextPage('secret-page');
    } else {
        alert("Wrong code, My Queen.");
    }
}

// --- RESET TO START (FIRST IMAGE INTERFACE) ---
function resetToLamp() {
    // 1. Hide the secret page and current panels
    const activePanel = document.querySelector('.panel.active');
    if(activePanel) {
        activePanel.classList.remove('active');
        activePanel.style.opacity = '0';
    }

    // 2. Bring back the dark room lamp interface
    darkRoom.style.display = "flex";
    setTimeout(() => {
        darkRoom.style.opacity = "1";
    }, 50);

    // 3. Reset the lamp handle and wire
    handle.classList.remove('heart-zoom');
    handle.style.transform = "translateY(0) rotate(-45deg)";
    wire.style.height = "200px";
    wire.style.opacity = "1";
    
    // 4. Show the instruction text again
    document.querySelector('.instruction').style.opacity = "1";
    
    // 5. Reset Music
    music.pause();
    music.currentTime = 0;
}

// --- PARTICLES ---
function createParticle() {
    const symbols = ['‚ú®', 'üíñ', 'üåπ', 'ü§ç', '‚ù§Ô∏è‚Äçü©π'];
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.innerHTML = symbols[Math.floor(Math.random() * symbols.length)];
    particle.style.left = Math.random() * 100 + 'vw';
    particle.style.fontSize = (Math.random() * 15 + 12) + 'px';
    particle.style.animationDuration = (Math.random() * 3 + 4) + 's';
    particleContainer.appendChild(particle);
    setTimeout(() => particle.remove(), 6000);
}
setInterval(createParticle, 400);
</script>
</body>
</html>
